<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Values - hololisp</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">User guide</li><li class="chapter-item expanded "><a href="../guide/compiling.html"><strong aria-hidden="true">2.</strong> Compiling</a></li><li class="chapter-item expanded "><a href="../guide/run.html"><strong aria-hidden="true">3.</strong> Running</a></li><li class="chapter-item expanded affix "><li class="part-title">Language description</li><li class="chapter-item expanded "><a href="../desc/design.html"><strong aria-hidden="true">4.</strong> Design</a></li><li class="chapter-item expanded "><a href="../desc/syntax.html"><strong aria-hidden="true">5.</strong> Syntax</a></li><li class="chapter-item expanded "><a href="../desc/values.html" class="active"><strong aria-hidden="true">6.</strong> Values</a></li><li class="chapter-item expanded "><a href="../desc/bytecode.html"><strong aria-hidden="true">7.</strong> Bytecode</a></li><li class="chapter-item expanded "><a href="../desc/compiler.html"><strong aria-hidden="true">8.</strong> Compiler</a></li><li class="chapter-item expanded "><a href="../desc/builtin.html"><strong aria-hidden="true">9.</strong> Builtin forms</a></li><li class="chapter-item expanded "><a href="../desc/macros.html"><strong aria-hidden="true">10.</strong> Macro system</a></li><li class="chapter-item expanded "><a href="../desc/s-expr/c-ffi.html"><strong aria-hidden="true">11.</strong> C FFI</a></li><li class="chapter-item expanded affix "><li class="part-title">Conclusion</li><li class="chapter-item expanded "><a href="../results.html"><strong aria-hidden="true">12.</strong> Results</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">hololisp</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="values"><a class="header" href="#values">Values</a></h1>
<blockquote>
<p>By 'value' we understand minimal instance of hololisp object that language can operate on.</p>
</blockquote>
<p>Hololisp currently supports several types of values:</p>
<ul>
<li>conses;</li>
<li>symbols;</li>
<li>numbers;</li>
<li>functions (and macros);</li>
<li>nil;</li>
<li>true;</li>
<li>C FFI function;</li>
<li>env.</li>
</ul>
<h2 id="nan-boxing"><a class="header" href="#nan-boxing">NAN-boxing</a></h2>
<p>Hololisp uses <a href="https://leonardschuetz.ch/blog/nan-boxing/">nan-boxing</a> along with <a href="https://en.wikipedia.org/wiki/Tagged_pointer">pointer tagging</a>. These techniques help to store different types of data in a single 64-bit unit of storage. hololisp practically benefits from this idea, being able to store handles to values in a single 64-bit integer.</p>
<p>All modern operating systems use only of 48 bits of program address space. Remaining 16 bits can be used to store any additional information that can be easily stripped with a mask leaving a bare pointer. This observation is a core idea behind pointer tagging, however, this idea can be extended to allow storing IEEE754 double-precision numbers in a same unit of storage due to the fact that IEEE754 defines special kind of number - NAN.
NAN numbers are defined using 11 bits of number, leave 52 bits of mantissa and 1 bit of sign without value. By a very neat coincidence, the bits occupied by NAN mask are unused in a pointer.</p>
<p>NAN-boxing is a common name for using bitwise representation of double to store all non-NAN real numbers, and use 53 other bits of double for storing additional information, for example, for storing pointers.
NAN-boxing is used by Hololisp along with pointer tagging to store 4 kinds of values in a single u64 storage unit:</p>
<ul>
<li>number;</li>
<li>nil;</li>
<li>true;</li>
<li>object pointer.</li>
</ul>
<p>where object pointer is a pointer to heap-allocated variable-sized storage for all not covered hololisp value kinds like conses, symbols and other.</p>
<p>These techniques help to store different types of data in a single 64-bit unit of storage. hololisp practically benefits from this idea, being able to store handles to values in a single 64-bit integer.</p>
<h2 id="conses"><a class="header" href="#conses">Conses</a></h2>
<p>Cons is a hololisp object that can hold two values. First element of a pair is called 'car', and second is called 'cdr'. These names are historical in lisp dialects.</p>
<p>Conses are frequently used to represent linked lists, where 'car' means data element of list node, and 'cdr' means next list node.</p>
<p>Linked lists consisting of conses are frequently called just 'lists' and are use throughout the language. For example, function arguments are passed in a list. </p>
<p>Linked lists are naturally flexible in use but offer constrained performance due to big number of heap allocations involved and O(n) time complexity of random access. hololisp tries to be idiomatic lisp dialect and does not offer generic array with O(1) random access complexity.</p>
<pre><code class="language-scheme">(define pair (cons 1 2))
; (define pair '(1 . 2)) - same as above 

(print (car pair)) ; 1 
(print (cdr pair)) ; (2)

(define lst (list 1 2 3 4))
(print (car lst))  ; 1 
(print (cdr list)) ; (2 3 4)

</code></pre>
<h2 id="symbol"><a class="header" href="#symbol">Symbol</a></h2>
<p>Symbol is a special object not frequently found in languages other that lisp dialects. Symbol is a string consisting of restricted set of characters. Symbols have a property that they evaluate to a value they are bound to. They are used to access variables and functions. </p>
<pre><code class="language-scheme">(define symb 'value)
(print symb)  ; value 
(print 'symb) ; symb
</code></pre>
<h2 id="number"><a class="header" href="#number">Number</a></h2>
<p>Hololisp numbers are IEEE754 doubles. Operations on numbers are done using builtin forms.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../desc/syntax.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../desc/bytecode.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../desc/syntax.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../desc/bytecode.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
